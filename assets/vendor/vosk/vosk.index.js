/**
 * Bundled by jsDelivr using Rollup v2.79.2 and Terser v5.39.0.
 * Original file: /npm/vosk@0.3.39/index.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import e from"ffi-napi";import r from"ref-napi";var n="undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{};function t(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}var i=t,s=o;function a(e){if(i===setTimeout)return setTimeout(e,0);if((i===t||!i)&&setTimeout)return i=setTimeout,setTimeout(e,0);try{return i(e,0)}catch(r){try{return i.call(null,e,0)}catch(r){return i.call(this,e,0)}}}"function"==typeof n.setTimeout&&(i=setTimeout),"function"==typeof n.clearTimeout&&(s=clearTimeout);var l,u=[],c=!1,f=-1;function v(){c&&l&&(c=!1,l.length?u=l.concat(u):f=-1,u.length&&_())}function _(){if(!c){var e=a(v);c=!0;for(var r=u.length;r;){for(l=u,u=[];++f<r;)l&&l[f].run();f=-1,r=u.length}l=null,c=!1,function(e){if(s===clearTimeout)return clearTimeout(e);if((s===o||!s)&&clearTimeout)return s=clearTimeout,clearTimeout(e);try{return s(e)}catch(r){try{return s.call(null,e)}catch(r){return s.call(this,e)}}}(e)}}function h(e,r){this.fun=e,this.array=r}h.prototype.run=function(){this.fun.apply(null,this.array)};function d(){}var m=d,p=d,g=d,w=d,k=d,b=d,y=d;var z=n.performance||{},T=z.now||z.mozNow||z.msNow||z.oNow||z.webkitNow||function(){return(new Date).getTime()};var A=new Date;var M={nextTick:function(e){var r=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)r[n-1]=arguments[n];u.push(new h(e,r)),1!==u.length||c||a(_)},title:"browser",browser:!0,env:{},argv:[],version:"",versions:{},on:m,addListener:p,once:g,off:w,removeListener:k,removeAllListeners:b,emit:y,binding:function(e){throw new Error("process.binding is not supported")},cwd:function(){return"/"},chdir:function(e){throw new Error("process.chdir is not supported")},umask:function(){return 0},hrtime:function(e){var r=.001*T.call(z),n=Math.floor(r),t=Math.floor(r%1*1e9);return e&&(n-=e[0],(t-=e[1])<0&&(n--,t+=1e9)),[n,t]},platform:"browser",release:{},config:{},uptime:function(){return(new Date-A)/1e3}},j="/app/.cache/npm/vosk@0.3.39";function E(e){return e&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var x,L={};function N(){if(void 0===x){var e=new ArrayBuffer(2),r=new Uint8Array(e),n=new Uint16Array(e);if(r[0]=1,r[1]=2,258===n[0])x="BE";else{if(513!==n[0])throw new Error("unable to figure out endianess");x="LE"}}return x}function O(){return void 0!==n.location?n.location.hostname:""}function S(){return[]}function P(){return 0}function D(){return Number.MAX_VALUE}function R(){return Number.MAX_VALUE}function I(){return[]}function J(){return"Browser"}function U(){return void 0!==n.navigator?n.navigator.appVersion:""}function W(){return{}}function B(){return{}}function V(){return"javascript"}function X(){return"browser"}function $(){return"/tmp"}var H=$;function q(){return"$HOME"}var C={homedir:q,EOL:"\n",arch:V,platform:X,tmpdir:H,tmpDir:$,networkInterfaces:W,getNetworkInterfaces:B,release:U,type:J,cpus:I,totalmem:R,freemem:D,uptime:P,loadavg:S,hostname:O,endianness:N},F=E(Object.freeze({__proto__:null,endianness:N,hostname:O,loadavg:S,uptime:P,freemem:D,totalmem:R,cpus:I,type:J,release:U,networkInterfaces:W,getNetworkInterfaces:B,arch:V,platform:X,tmpDir:$,tmpdir:H,EOL:"\n",homedir:q,default:C}));function G(e,r){for(var n=0,t=e.length-1;t>=0;t--){var o=e[t];"."===o?e.splice(t,1):".."===o?(e.splice(t,1),n++):n&&(e.splice(t,1),n--)}if(r)for(;n--;n)e.unshift("..");return e}var K=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,Q=function(e){return K.exec(e).slice(1)};function Y(){for(var e="",r=!1,n=arguments.length-1;n>=-1&&!r;n--){var t=n>=0?arguments[n]:"/";if("string"!=typeof t)throw new TypeError("Arguments to path.resolve must be strings");t&&(e=t+"/"+e,r="/"===t.charAt(0))}return(r?"/":"")+(e=G(ae(e.split("/"),(function(e){return!!e})),!r).join("/"))||"."}function Z(e){var r=ee(e),n="/"===le(e,-1);return(e=G(ae(e.split("/"),(function(e){return!!e})),!r).join("/"))||r||(e="."),e&&n&&(e+="/"),(r?"/":"")+e}function ee(e){return"/"===e.charAt(0)}function re(){return Z(ae(Array.prototype.slice.call(arguments,0),(function(e,r){if("string"!=typeof e)throw new TypeError("Arguments to path.join must be strings");return e})).join("/"))}function ne(e,r){function n(e){for(var r=0;r<e.length&&""===e[r];r++);for(var n=e.length-1;n>=0&&""===e[n];n--);return r>n?[]:e.slice(r,n-r+1)}e=Y(e).substr(1),r=Y(r).substr(1);for(var t=n(e.split("/")),o=n(r.split("/")),i=Math.min(t.length,o.length),s=i,a=0;a<i;a++)if(t[a]!==o[a]){s=a;break}var l=[];for(a=s;a<t.length;a++)l.push("..");return(l=l.concat(o.slice(s))).join("/")}function te(e){var r=Q(e),n=r[0],t=r[1];return n||t?(t&&(t=t.substr(0,t.length-1)),n+t):"."}function oe(e,r){var n=Q(e)[2];return r&&n.substr(-1*r.length)===r&&(n=n.substr(0,n.length-r.length)),n}function ie(e){return Q(e)[3]}var se={extname:ie,basename:oe,dirname:te,sep:"/",delimiter:":",relative:ne,join:re,isAbsolute:ee,normalize:Z,resolve:Y};function ae(e,r){if(e.filter)return e.filter(r);for(var n=[],t=0;t<e.length;t++)r(e[t],t,e)&&n.push(e[t]);return n}var le="b"==="ab".substr(-1)?function(e,r,n){return e.substr(r,n)}:function(e,r,n){return r<0&&(r=e.length+r),e.substr(r,n)};const ue=F,ce=E(Object.freeze({__proto__:null,resolve:Y,normalize:Z,isAbsolute:ee,join:re,relative:ne,sep:"/",delimiter:":",dirname:te,basename:oe,extname:ie,default:se})),fe=e,ve=r,_e=ve.types.void,he=ve.refType(_e),de=ve.types.void,me=ve.refType(de),pe=ve.types.void,ge=ve.refType(pe);let we;if("win32"==ue.platform()){let e=M.env.Path,r=ce.resolve(ce.join(j,"lib","win-x86_64"));M.env.Path=e+ce.delimiter+r,we=ce.join(j,"lib","win-x86_64","libvosk.dll")}else we="darwin"==ue.platform()?ce.join(j,"lib","osx-universal","libvosk.dylib"):ce.join(j,"lib","linux-x86_64","libvosk.so");const ke=fe.Library(we,{vosk_set_log_level:["void",["int"]],vosk_model_new:[he,["string"]],vosk_model_free:["void",[he]],vosk_spk_model_new:[me,["string"]],vosk_spk_model_free:["void",[me]],vosk_recognizer_new:[ge,[he,"float"]],vosk_recognizer_new_spk:[ge,[he,"float",me]],vosk_recognizer_new_grm:[ge,[he,"float","string"]],vosk_recognizer_free:["void",[ge]],vosk_recognizer_set_max_alternatives:["void",[ge,"int"]],vosk_recognizer_set_words:["void",[ge,"bool"]],vosk_recognizer_set_partial_words:["void",[ge,"bool"]],vosk_recognizer_set_spk_model:["void",[ge,me]],vosk_recognizer_accept_waveform:["bool",[ge,"pointer","int"]],vosk_recognizer_result:["string",[ge]],vosk_recognizer_final_result:["string",[ge]],vosk_recognizer_partial_result:["string",[ge]],vosk_recognizer_reset:["void",[ge]]});function be(e,r){return e.hasOwnProperty(r)}var ye=L.setLogLevel=function(e){ke.vosk_set_log_level(e)},ze=L.Model=class{constructor(e){this.handle=ke.vosk_model_new(e)}free(){ke.vosk_model_free(this.handle)}},Te=L.SpeakerModel=class{constructor(e){this.handle=ke.vosk_spk_model_new(e)}free(){ke.vosk_spk_model_free(this.handle)}},Ae=L.Recognizer=class{constructor(e){const{model:r,sampleRate:n}=e;if(be(e,"speakerModel")&&be(e,"grammar"))throw new Error("grammar and speakerModel cannot be used together for now.");this.handle=be(e,"speakerModel")?ke.vosk_recognizer_new_spk(r.handle,n,e.speakerModel.handle):be(e,"grammar")?ke.vosk_recognizer_new_grm(r.handle,n,JSON.stringify(e.grammar)):ke.vosk_recognizer_new(r.handle,n)}free(){ke.vosk_recognizer_free(this.handle)}setMaxAlternatives(e){ke.vosk_recognizer_set_max_alternatives(this.handle,e)}setWords(e){ke.vosk_recognizer_set_words(this.handle,e)}setPartialWords(e){ke.vosk_recognizer_set_partial_words(this.handle,e)}setSpkModel(e){ke.vosk_recognizer_set_spk_model(this.handle,e.handle)}acceptWaveform(e){return ke.vosk_recognizer_accept_waveform(this.handle,e,e.length)}acceptWaveformAsync(e){return new Promise(((r,n)=>{ke.vosk_recognizer_accept_waveform.async(this.handle,e,e.length,(function(e,t){e?n(e):r(t)}))}))}resultString(){return ke.vosk_recognizer_result(this.handle)}result(){return JSON.parse(ke.vosk_recognizer_result(this.handle))}partialResult(){return JSON.parse(ke.vosk_recognizer_partial_result(this.handle))}finalResult(){return JSON.parse(ke.vosk_recognizer_final_result(this.handle))}reset(){ke.vosk_recognizer_reset(this.handle)}};export{ze as Model,Ae as Recognizer,Te as SpeakerModel,L as default,ye as setLogLevel};
